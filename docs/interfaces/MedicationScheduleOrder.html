<!doctype html>
<html class="no-js" lang="">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>calvin-emr documentation</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link rel="icon" type="image/x-icon" href="../images/favicon.ico">
	   <link rel="stylesheet" href="../styles/style.css">
        <link rel="stylesheet" href="../styles/dark.css">
    </head>
    <body>

        <div class="navbar navbar-default navbar-fixed-top visible-xs">
            <a href="../" class="navbar-brand">calvin-emr documentation</a>
            <button type="button" class="btn btn-default btn-menu ion-ios-menu" id="btn-menu"></button>
        </div>

        <div class="xs-menu menu" id="mobile-menu">
                <div id="book-search-input" role="search"><input type="text" placeholder="Type to search"></div>            <compodoc-menu></compodoc-menu>
        </div>

        <div class="container-fluid main">
           <div class="row main">
               <div class="hidden-xs menu">
                   <compodoc-menu mode="normal"></compodoc-menu>
               </div>
               <!-- START CONTENT -->
               <div class="content interface">
                   <div class="content-data">













<ol class="breadcrumb">
  <li>Interfaces</li>
  <li
  >
  MedicationScheduleOrder</li>
</ol>

<ul class="nav nav-tabs" role="tablist">
        <li class="active">
            <a href="#info" role="tab" id="info-tab" data-toggle="tab" data-link="info">Info</a>
        </li>
        <li >
            <a href="#source" role="tab" id="source-tab" data-toggle="tab" data-link="source">Source</a>
        </li>
</ul>

<div class="tab-content">
    <div class="tab-pane fade active in" id="c-info">
        <p class="comment">
            <h3>File</h3>
        </p>
        <p class="comment">
            <code>src/app/patient-dashboard/mar/medication-schedule/medication-schedule.component.ts</code>
        </p>




        <section>
            <h3 id="index">Index</h3>
            <table class="table table-sm table-bordered index-table">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <h6><b>Properties</b></h6>
                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <ul class="index-list">
                                <li>
                                        <a href="#endDate" 
>
                                            endDate
                                        </a>
                                </li>
                                <li>
                                        <a href="#endTimeString" 
>
                                            endTimeString
                                        </a>
                                </li>
                                <li>
                                        <a href="#id" 
>
                                            id
                                        </a>
                                </li>
                                <li>
                                        <a href="#medId" 
>
                                            medId
                                        </a>
                                </li>
                                <li>
                                        <a href="#medName" 
>
                                            medName
                                        </a>
                                </li>
                                <li>
                                        <a href="#quantity" 
>
                                            quantity
                                        </a>
                                </li>
                                <li>
                                        <a href="#quantityGiven" 
>
                                            quantityGiven
                                        </a>
                                </li>
                                <li>
                                        <a href="#route" 
>
                                            route
                                        </a>
                                </li>
                                <li>
                                        <a href="#startDate" 
>
                                            startDate
                                        </a>
                                </li>
                                <li>
                                        <a href="#startTimeString" 
>
                                            startTimeString
                                        </a>
                                </li>
                            </ul>
                        </td>
                    </tr>
                </tbody>
            </table>
        </section>



            <section>
                <h3 id="inputs">Properties</h3>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="endDate"></a>
                                        <span class="name "><b>endDate</b>
                                            <a href="#endDate">
                                                <span class="icon ion-ios-link"></span>
                                            </a>
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>endDate:         <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date" target="_blank" >Date</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date" target="_blank" >Date</a></code>

                                        </td>
                                    </tr>





                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="endTimeString"></a>
                                        <span class="name "><b>endTimeString</b>
                                            <a href="#endTimeString">
                                                <span class="icon ion-ios-link"></span>
                                            </a>
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>endTimeString:         <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                                        </td>
                                    </tr>





                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="id"></a>
                                        <span class="name "><b>id</b>
                                            <a href="#id">
                                                <span class="icon ion-ios-link"></span>
                                            </a>
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>id:         <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                                        </td>
                                    </tr>





                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="medId"></a>
                                        <span class="name "><b>medId</b>
                                            <a href="#medId">
                                                <span class="icon ion-ios-link"></span>
                                            </a>
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>medId:         <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                                        </td>
                                    </tr>





                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="medName"></a>
                                        <span class="name "><b>medName</b>
                                            <a href="#medName">
                                                <span class="icon ion-ios-link"></span>
                                            </a>
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>medName:         <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                                        </td>
                                    </tr>





                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="quantity"></a>
                                        <span class="name "><b>quantity</b>
                                            <a href="#quantity">
                                                <span class="icon ion-ios-link"></span>
                                            </a>
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>quantity:         <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/number" target="_blank" >number</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/number" target="_blank" >number</a></code>

                                        </td>
                                    </tr>





                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="quantityGiven"></a>
                                        <span class="name "><b>quantityGiven</b>
                                            <a href="#quantityGiven">
                                                <span class="icon ion-ios-link"></span>
                                            </a>
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>quantityGiven:         <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/number" target="_blank" >number</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/number" target="_blank" >number</a></code>

                                        </td>
                                    </tr>





                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="route"></a>
                                        <span class="name "><b>route</b>
                                            <a href="#route">
                                                <span class="icon ion-ios-link"></span>
                                            </a>
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>route:         <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                                        </td>
                                    </tr>





                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="startDate"></a>
                                        <span class="name "><b>startDate</b>
                                            <a href="#startDate">
                                                <span class="icon ion-ios-link"></span>
                                            </a>
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>startDate:         <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date" target="_blank" >Date</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date" target="_blank" >Date</a></code>

                                        </td>
                                    </tr>





                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="startTimeString"></a>
                                        <span class="name "><b>startTimeString</b>
                                            <a href="#startTimeString">
                                                <span class="icon ion-ios-link"></span>
                                            </a>
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>startTimeString:         <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                                        </td>
                                    </tr>





                        </tbody>
                    </table>
            </section>
    </div>


    <div class="tab-pane fade  tab-source-code" id="c-source">
        <pre class="line-numbers compodoc-sourcecode"><code class="language-typescript">import { Component, OnInit, ViewChild } from &#x27;@angular/core&#x27;;
import { ERROR, HOUR24_TIME_CONFIG } from &#x27;src/app/global&#x27;;
import { DxSchedulerComponent } from &#x27;devextreme-angular&#x27;;
import { DialogService } from &#x27;primeng/dynamicdialog&#x27;;
import { ProviderOrder } from &#x27;src/app/shared/models/provider-order.model&#x27;;
import { PatientDashboardStore } from &#x27;src/app/patient-dashboard/state/patient-dashboard.store&#x27;;
import { AdministrationScheduleComponent } from &#x27;../administration-schedule/administration-schedule.component&#x27;;
import { ToastService } from &#x27;src/app/shared/services/toast.service&#x27;;

export interface MedicationScheduleOrder {
  id: string;
  medId: string;

  // Used to display info in the order tooltip
  medName: string;
  route: string;
  quantityGiven: number;
  quantity: number;

  // Used by the dx-scheduler to render the order&#x27;s box
  startDate: Date;
  endDate: Date;

  // Used to display the start and end times of the order within the order box
  startTimeString: string;
  endTimeString: string;
}

@Component({
  selector: &#x27;app-medication-schedule&#x27;,
  templateUrl: &#x27;./medication-schedule.component.html&#x27;,
  styleUrls: [&#x27;./medication-schedule.component.scss&#x27;],
  providers: [DialogService],
})
export class MedicationScheduleComponent extends AdministrationScheduleComponent implements OnInit {
  @ViewChild(&#x27;scheduler&#x27;, { static: true }) scheduler!: DxSchedulerComponent;

  /**
   * The Medication object property to use in each appointment&#x27;s subject line.
   * This line appears at the top of each appointment box.
   */
  textExpr: string &#x3D; &#x27;medName&#x27;;

  /**
   * The Medication object property to use to define the start of an appointment.
   */
  startDateExpr: string &#x3D; &#x27;startDate&#x27;;

  /**
   * The Medication object property to use to define the end of an appointment.
   */
  endDateExpr: string &#x3D; &#x27;endDate&#x27;;

  /**
   * The hour (out of 24) to start each day on.
   */
  startDayHour: number &#x3D; 7;

  /**
   * The hour (out of 24) to end each day on.
   */
  endDayHour: number &#x3D; 20;

  /**
   * The different views that can be displayed on the scheduler.
   */
  views: string[] &#x3D; [&#x27;day&#x27;, &#x27;week&#x27;, &#x27;month&#x27;];

  /**
   * The default view of the scheduler. Either &#x27;day&#x27; or &#x27;week&#x27;.
   */
  currentView: string &#x3D; &#x27;week&#x27;;

  /**
   * The format of the time labels on the scheduler.
   */
  timeCellTemplate &#x3D; function (e: any) {
    return new Date(e.date).toLocaleString([], HOUR24_TIME_CONFIG);
  };

  /**
   * Specifies that the current day/time will be marked on the scheduler.
   */
  showCurrentTimeIndicator: boolean &#x3D; true;

  /**
   * Specifies that the scheduler will be shaded a darker gray at all times
   * before the current day/time.
   */
  shadeUntilCurrentTime: boolean &#x3D; true;

  // currentDate is s|n|D because there will be compilation errors
  // if it is only Date. No idea why; maybe TypeScript issue?
  // @Input() currentDate: string | number | Date &#x3D; new Date();
  currentDate: string | number | Date &#x3D; new Date();

  displayedOrders: object[] &#x3D; [];

  constructor(patientStore: PatientDashboardStore, dialogService: DialogService, private toastService: ToastService) {
    super(patientStore, dialogService);

    this.patient$.subscribe((patient) &#x3D;&gt; {
      this.orders &#x3D; patient.providerOrders.filter((order) &#x3D;&gt; order.isScheduled);
      this.displayedOrders &#x3D; this.getDisplayedOrders();
    });
  }

  ngOnInit(): void {}

  /**
   * Converts ProviderOrder objects into objects that can be passed into the dx-scheduler.
   */
  getDisplayedOrders(): MedicationScheduleOrder[] {
    return this.orders.map((order: ProviderOrder) &#x3D;&gt; {
      return {
        id: order.id,
        medId: order.medId,
        medName: order.medName,
        route: order.route,
        quantityGiven: order.quantityGiven,
        quantity: order.quantity,
        startDate: order.startDate?.toDate(),
        endDate: order.endDate?.toDate(),
        startTimeString: order.startTimeString,
        endTimeString: order.endTimeString,
      } as MedicationScheduleOrder;
    });
  }

  /**
   * Repaints the dx-scheduler so that the appointments render correctly.
   */
  refresh() {
    this.scheduler.instance.repaint();
  }

  /**
   * Sets the background color of the current appointment, and formats the subject line to contain
   * the medication name and time to administer.
   *
   * @param event object containing information about the appointment that is being rendered, including
   *  the Appointment object and the appointment styling.
   */
  renderAppointment(event: any) {
    // Set background color of appointment
    event.appointmentElement.style.backgroundColor &#x3D; this.getBackgroundColor(event.appointmentData);

    // Specify that scheduler should show tooltip when user hovers over appointment
    var el &#x3D; event.appointmentElement;
    el.onmouseenter &#x3D; function () {
      event.component.showAppointmentTooltip(
        event.appointmentData,
        event.appointmentElement,
        event.targetedAppointmentData
      );
    };
    el.onmouseleave &#x3D; function () {
      event.component.hideAppointmentTooltip();
    };
  }

  /**
   * Cancels the default dx-scheduler popup and instead opens the AdministerMedDialog component.
   *
   * @param orderEvent object containing information about the appointment clicked on the dx-scheduler
   */
  overrideDefaultPopup(orderEvent: any) {
    let displayedOrder &#x3D; orderEvent.appointmentData;

    if (displayedOrder) {
      // Cancel the default popup that dx-scheduler creates
      orderEvent.cancel &#x3D; true;

      // TODO: check with nursing profs if clickable after max qty administered
      // if(!apt.administered) {
      // let med &#x3D; new Order();
      // Object.assign(med, apt)
      // this.openVerifyDialog(aptEvent, this.patientName, this.patientId, med);
      // }

      // Retrieve the actual order from the orders array
      let order &#x3D; this.orders.find((o: ProviderOrder) &#x3D;&gt; o.id &#x3D;&#x3D;&#x3D; displayedOrder.id);
      if (order) {
        // Open custom dialog regardless of whether med has/hasn&#x27;t been administered
        this.openAdministerMedDialog(order);
      } else {
        this.toastService.clear();
        this.toastService.addOne({
          severity: ERROR,
          summary: &#x27;Error&#x27;,
          detail: &#x60;Unable to open order ${displayedOrder.id}!&#x60;,
        });
      }
    }
  }

  /**
   * @param order Order object
   * @returns hex code of &quot;administered&quot;/&quot;not administered&quot; color
   */
  getBackgroundColor(order: any) {
    if (order.quantityGiven &gt;&#x3D; order.quantity) {
      return &#x27;#999999&#x27;;
    }
    return &#x27;#3F51B5&#x27;;
  }
}
</code></pre>
    </div>
</div>








                   </div><div class="search-results">
    <div class="has-results">
        <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
        <ul class="search-results-list"></ul>
    </div>
    <div class="no-results">
        <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
    </div>
</div>
</div>
               <!-- END CONTENT -->
           </div>
       </div>

          <label class="dark-mode-switch">
               <input type="checkbox">
               <span class="slider">
                    <svg class="slider-icon" viewBox="0 0 24 24" fill="none" height="20" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" width="20" xmlns="http://www.w3.org/2000/svg">
                    <path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"></path>
                    </svg>
               </span>
          </label>

       <script>
            var COMPODOC_CURRENT_PAGE_DEPTH = 1;
            var COMPODOC_CURRENT_PAGE_CONTEXT = 'interface';
            var COMPODOC_CURRENT_PAGE_URL = 'MedicationScheduleOrder.html';
            var MAX_SEARCH_RESULTS = 15;
       </script>

       <script src="../js/libs/custom-elements.min.js"></script>
       <script src="../js/libs/lit-html.js"></script>

       <script src="../js/menu-wc.js" defer></script>
       <script nomodule src="../js/menu-wc_es5.js" defer></script>

       <script src="../js/libs/bootstrap-native.js"></script>

       <script src="../js/libs/es6-shim.min.js"></script>
       <script src="../js/libs/EventDispatcher.js"></script>
       <script src="../js/libs/promise.min.js"></script>
       <script src="../js/libs/zepto.min.js"></script>

       <script src="../js/compodoc.js"></script>

       <script src="../js/tabs.js"></script>
       <script src="../js/menu.js"></script>
       <script src="../js/libs/clipboard.min.js"></script>
       <script src="../js/libs/prism.js"></script>
       <script src="../js/sourceCode.js"></script>
          <script src="../js/search/search.js"></script>
          <script src="../js/search/lunr.min.js"></script>
          <script src="../js/search/search-lunr.js"></script>
          <script src="../js/search/search_index.js"></script>
       <script src="../js/lazy-load-graphs.js"></script>


    </body>
</html>
